# Gitleaks configuration for AEGIS
# Sprint: Y10.12

title = "AEGIS Secret Scanning"

[allowlist]
description = "Global allowlist"
paths = [
    '''node_modules/''',
    '''target/''',
    '''.anchor/''',
    '''\.lock$''',
    '''package-lock\.json$''',
]

# Custom rules for blockchain projects
[[rules]]
id = "solana-private-key"
description = "Potential Solana private key (base58, 64+ chars)"
regex = '''[1-9A-HJ-NP-Za-km-z]{64,88}'''
keywords = ["private", "secret", "key"]
entropy = 4.5

[[rules]]
id = "solana-keypair-array"
description = "Solana keypair as JSON array"
regex = '''\[(\s*\d{1,3}\s*,){31,63}\s*\d{1,3}\s*\]'''
keywords = ["keypair", "wallet"]

[[rules]]
id = "anchor-provider-wallet"
description = "Hardcoded Anchor wallet path"
regex = '''ANCHOR_WALLET\s*=\s*['"](/[^'"]+\.json)['"]'''

[[rules]]
id = "jwt-secret"
description = "Hardcoded JWT secret"
regex = '''(?i)(jwt|token)[\s_-]?secret[\s=:]+['""]([^'""]{16,})[''""]'''

[[rules]]
id = "api-key-generic"
description = "Generic API key pattern"
regex = '''(?i)(api|auth)[\s_-]?key[\s=:]+['"]([a-zA-Z0-9_\-]{20,})['"]'''

[[rules]]
id = "private-key-pem"
description = "Private key in PEM format"
regex = '''-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----'''

[[rules]]
id = "ipfs-gateway-key"
description = "IPFS Pinata or Infura key"
regex = '''(?i)(pinata|infura)[\s_-]?(api|secret)[\s_-]?key[\s=:]+['"]([a-zA-Z0-9]{20,})['"]'''

# Standard rules to keep
[[rules]]
id = "aws-access-token"
description = "AWS Access Token"
regex = '''(?i)aws(.{0,20})?access(.{0,20})?key(.{0,20})?['"]?[=:\s]+['"]?(?P<secret>AKIA[0-9A-Z]{16})['"]?'''

[[rules]]
id = "github-token"
description = "GitHub Token"
regex = '''(?i)github(.{0,20})?token(.{0,20})?['"]?[=:\s]+['"]?(?P<secret>ghp_[a-zA-Z0-9]{36})['"]?'''

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''

[[rules]]
id = "generic-password"
description = "Generic Password Assignment"
regex = '''(?i)(password|passwd|pwd)[\s=:]+['"](?P<secret>[^'"]{8,})['"]'''
entropy = 3.5

# Allowlist specific patterns (false positives)
[[rules.allowlist]]
regexes = [
    '''example''',
    '''test''',
    '''dummy''',
    '''placeholder''',
    '''XXXXXXXX''',
]
